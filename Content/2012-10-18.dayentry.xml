<?xml version="1.0" encoding="utf-8"?>
<DayEntry xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:newtelligence-com:dasblog:runtime:data">
  <Date>2012-10-17T20:00:00-04:00</Date>
  <Entries>
    <Entry>
      <Content>&lt;p&gt;Ch33 in Silverlight 5 in Action book.&lt;/p&gt;  &lt;p&gt;Testing is one of the main drivers behind MVVM&lt;/p&gt;  &lt;ul&gt;   &lt;li&gt;New project – Silverlight Navigation Application&lt;/li&gt; &lt;/ul&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_2.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb.png" width="611" height="345" /&gt;&lt;/a&gt;    &lt;br /&gt;Issue with blurry fonts in IE10&lt;/p&gt;  &lt;p&gt;&amp;#160;&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_4.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_1.png" width="284" height="303" /&gt;&lt;/a&gt;    &lt;br /&gt;Database is slightly different from one in book&lt;/p&gt;  &lt;p&gt;This one was from SQLExpress2008.&amp;#160; &lt;a href="http://msftdbprodsamples.codeplex.com/releases/view/4004"&gt;http://msftdbprodsamples.codeplex.com/releases/view/4004&lt;/a&gt;&amp;#160; this is the database schema that is used in the book (SQL2005 version)&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_6.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_2.png" width="385" height="322" /&gt;&lt;/a&gt;&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_8.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_3.png" width="351" height="427" /&gt;&lt;/a&gt;    &lt;br /&gt;The correct schema&lt;/p&gt;  &lt;h3&gt;Webservice&lt;/h3&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_10.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_4.png" width="656" height="238" /&gt;&lt;/a&gt;&lt;/p&gt;        &lt;p&gt;A regular Silverlight-enabled WCF service: a SOAP web service built using WCF&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_12.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_5.png" width="617" height="344" /&gt;&lt;/a&gt;    &lt;br /&gt;Locking the port too.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_14.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_6.png" width="612" height="366" /&gt;&lt;/a&gt;    &lt;br /&gt;Added a new EmployeeList page and wired it into the navigation.&amp;#160; Now doing a child window called EmployeeDetail.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_16.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_7.png" width="586" height="445" /&gt;&lt;/a&gt;    &lt;br /&gt;TextBlocks (labels) and TextBox’s (inputs) with TwoWay binding.&lt;/p&gt;  &lt;h3&gt;Typical Code Behind Solution&lt;/h3&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_18.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_8.png" width="338" height="239" /&gt;&lt;/a&gt;    &lt;br /&gt;&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_20.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_9.png" width="244" height="87" /&gt;&lt;/a&gt;    &lt;br /&gt;Should be like this (default code gen)&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_22.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_10.png" width="244" height="78" /&gt;&lt;/a&gt;    &lt;br /&gt;But was this (no code gen)&lt;/p&gt;            &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_24.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_11.png" width="654" height="299" /&gt;&lt;/a&gt;&lt;/p&gt;  &lt;p&gt;Page Caching is turned on.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_26.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_12.png" width="451" height="315" /&gt;&lt;/a&gt;&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_28.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_13.png" width="555" height="172" /&gt;&lt;/a&gt;&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_30.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_14.png" width="568" height="290" /&gt;&lt;/a&gt;    &lt;br /&gt;Child window popping up when press edit.&amp;#160; We don’t clone the Employee here, so cancel doesn’t work if we change a value.. it automatically updates the underlying object, but doesn’t update the database.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_32.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_15.png" width="454" height="130" /&gt;&lt;/a&gt;    &lt;br /&gt;In EmployeeList when edit button is pressed, we make a new EmployeeDetail View as pass it the Employee.&amp;#160; When the Employee property of the View is set, we set the DataContext to use that employee too.&lt;/p&gt;  &lt;ul&gt;   &lt;li&gt;Filling a list from a service call&lt;/li&gt;    &lt;li&gt;Passing information from 1 view to another&lt;/li&gt; &lt;/ul&gt;  &lt;h3&gt;MVVM Version&lt;/h3&gt;  &lt;p&gt;The most popular pattern for SL and WPF.&lt;/p&gt;  &lt;ul&gt;   &lt;li&gt;testable&lt;/li&gt;    &lt;li&gt;code reuse&lt;/li&gt;    &lt;li&gt;elimates many of the binding problems&lt;/li&gt; &lt;/ul&gt;  &lt;p&gt;The View uses Binding and Messages (actions or commands) to communicate with the ViewModel&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_34.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_16.png" width="423" height="207" /&gt;&lt;/a&gt;    &lt;br /&gt;Base ViewModel.&amp;#160; INotifyPropertyChanged is required when other classes may be bound to your class.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_36.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_17.png" width="416" height="292" /&gt;&lt;/a&gt;    &lt;br /&gt;Codebehind in the XAML makes a EmployeeListViewModel then calls the LoadEmployees method on it.    &lt;br /&gt;Also sets up an event which fires when loading is complete so loading window disappears&lt;/p&gt;    &lt;h3&gt;Single Responsibility&lt;/h3&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_38.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_18.png" width="348" height="321" /&gt;&lt;/a&gt;    &lt;br /&gt;Driving out into a separate class Vacation bonus logic away from the ViewModel.&amp;#160; However this depends on Employee.&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_40.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_19.png" width="284" height="98" /&gt;&lt;/a&gt;    &lt;br /&gt;ViewModel&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_42.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_20.png" width="343" height="299" /&gt;&lt;/a&gt;    &lt;br /&gt;Better version of vacation as no dependency&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_44.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_21.png" width="732" height="116" /&gt;&lt;/a&gt;    &lt;br /&gt;Calling code in EmployeeListViewModel&lt;/p&gt;      &lt;h3&gt;Data Access and Service Calls&lt;/h3&gt;  &lt;p&gt;Abstracting service/data access calls away from the ViewModel&lt;/p&gt;  &lt;p&gt;&lt;a href="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_46.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.programgood.net/content/binary/Windows-Live-Writer/Structuring-and-Testing-with-the-MVVM-Pa_9163/image_thumb_22.png" width="378" height="481" /&gt;&lt;/a&gt;&lt;/p&gt;  &lt;p&gt;However lots of EventHandler code in DataService, ViewModel and Code Behind.&lt;/p&gt;</Content>
      <Created>2012-10-18T11:43:45.9203467-04:00</Created>
      <Modified>2012-10-18T11:43:45.9203467-04:00</Modified>
      <EntryId>86e2e704-0a05-4878-a352-66722ef93fca</EntryId>
      <Description />
      <Title>Structuring and Testing with the MVVM Pattern</Title>
      <Categories>MVVM;Silverlight</Categories>
      <Author>admin</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>true</AllowComments>
      <Attachments />
      <Crossposts />
      <Latitude xsi:nil="true" />
      <Longitude xsi:nil="true" />
    </Entry>
  </Entries>
</DayEntry>